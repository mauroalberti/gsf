<!--?xml version="1.0" encoding="UTF-8"?-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<!-- Generated by HsColour, http://www.cs.york.ac.uk/fp/darcs/hscolour/ -->
<title>Data/Vector.hs</title>
<link type="text/css" rel="stylesheet" href="Data_Vector.hs_files/hscolour.css">
</head>
<body>
<pre><a name="line-1"></a><span class="hs-comment">{- |
<a name="line-2"></a>  This module provides several small vectors over @Double@ values.
<a name="line-3"></a>  All fields are strict and unpacked, so using these should be
<a name="line-4"></a>  fairly efficient. Each size of vector is a seperate type. It also
<a name="line-5"></a>  provides a few vector constants to save you some typing now and
<a name="line-6"></a>  then.
<a name="line-7"></a>-}</span>
<a name="line-8"></a>
<a name="line-9"></a><span class="hs-keyword">module</span> <span class="hs-conid">Data</span><span class="hs-varop">.</span><span class="hs-conid">Vector</span> <span class="hs-keyword">where</span>
<a name="line-10"></a>
<a name="line-11"></a><a name="Scalar"></a><span class="hs-comment">{- | The type of @Vector@ fields. -}</span>
<a name="line-12"></a><a name="Scalar"></a><span class="hs-keyword">type</span> <span class="hs-conid">Scalar</span> <span class="hs-keyglyph">=</span> <span class="hs-conid">Double</span>
<a name="line-13"></a>
<a name="line-14"></a><span class="hs-comment">{- |
<a name="line-15"></a>  The @Vector@ class. All vectors are members of this class,
<a name="line-16"></a>  and it provides ways to apply functions over vectors.
<a name="line-17"></a>  Typically this methods aren't used directly; rather, the
<a name="line-18"></a>  other class instances for each vector are implemented
<a name="line-19"></a>  in terms of these.
<a name="line-20"></a>-}</span>
<a name="line-21"></a><span class="hs-keyword">class</span> <span class="hs-conid">Vector</span> <span class="hs-varid">v</span> <span class="hs-keyword">where</span>
<a name="line-22"></a>  <span class="hs-varid">fromScalar</span> <span class="hs-keyglyph">::</span> <span class="hs-conid">Scalar</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">v</span>
<a name="line-23"></a>  <span class="hs-varid">vmap</span>       <span class="hs-keyglyph">::</span> <span class="hs-layout">(</span><span class="hs-conid">Scalar</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Scalar</span><span class="hs-layout">)</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">v</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">v</span>
<a name="line-24"></a>  <span class="hs-varid">vzip</span>       <span class="hs-keyglyph">::</span> <span class="hs-layout">(</span><span class="hs-conid">Scalar</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Scalar</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Scalar</span><span class="hs-layout">)</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">v</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">v</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">v</span>
<a name="line-25"></a>  <span class="hs-varid">vfold</span>      <span class="hs-keyglyph">::</span> <span class="hs-layout">(</span><span class="hs-conid">Scalar</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Scalar</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Scalar</span><span class="hs-layout">)</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">v</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Scalar</span>
<a name="line-26"></a>
<a name="line-27"></a><a name="vdot"></a><span class="hs-comment">{- |
<a name="line-28"></a>  Takes the /dot product/ of two vectors [of the same dimension].
<a name="line-29"></a>  If you remember your highschool linear algebra, the dot product
<a name="line-30"></a>  of two vectors V and W is equal to |V| * |W| * cos k, where
<a name="line-31"></a>  |V| is the length of vector V, and k is the minimum angle
<a name="line-32"></a>  between the two vectors.
<a name="line-33"></a>-}</span>
<a name="line-34"></a><span class="hs-definition">vdot</span> <span class="hs-keyglyph">::</span> <span class="hs-conid">Vector</span> <span class="hs-varid">v</span> <span class="hs-keyglyph">=&gt;</span> <span class="hs-varid">v</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">v</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Scalar</span>
<a name="line-35"></a><span class="hs-definition">vdot</span> <span class="hs-varid">v</span> <span class="hs-varid">w</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">vfold</span> <span class="hs-layout">(</span><span class="hs-varop">+</span><span class="hs-layout">)</span> <span class="hs-varop">$</span> <span class="hs-varid">vzip</span> <span class="hs-layout">(</span><span class="hs-varop">*</span><span class="hs-layout">)</span> <span class="hs-varid">v</span> <span class="hs-varid">w</span>
<a name="line-36"></a>
<a name="line-37"></a><a name="vmag"></a><span class="hs-comment">{- |
<a name="line-38"></a>  Returns the /magnitude/ of a vector (that is, it's length).
<a name="line-39"></a>  Note that this is always positive or zero (never negative).
<a name="line-40"></a>-}</span>
<a name="line-41"></a><span class="hs-definition">vmag</span> <span class="hs-keyglyph">::</span> <span class="hs-conid">Vector</span> <span class="hs-varid">v</span> <span class="hs-keyglyph">=&gt;</span> <span class="hs-varid">v</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Scalar</span>
<a name="line-42"></a><span class="hs-definition">vmag</span> <span class="hs-varid">v</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">sqrt</span> <span class="hs-varop">$</span> <span class="hs-varid">v</span> <span class="hs-varop">`vdot`</span> <span class="hs-varid">v</span>
<a name="line-43"></a>
<a name="line-44"></a><a name="|*"></a><span class="hs-comment">{- |
<a name="line-45"></a>  Multiply a vector by a scalar. This scales the magnitude
<a name="line-46"></a>  (length) of the vector, but leaves its length unchanged.
<a name="line-47"></a>  (Except in the case of a negative scalar, in which case
<a name="line-48"></a>  the vector's direction is reversed.)
<a name="line-49"></a>
<a name="line-50"></a>  The operators '|*' and '*|' are identical, just with their
<a name="line-51"></a>  arguments flipped.
<a name="line-52"></a>-}</span>
<a name="line-53"></a><span class="hs-layout">(</span><span class="hs-varop">|*</span><span class="hs-layout">)</span> <span class="hs-keyglyph">::</span> <span class="hs-conid">Vector</span> <span class="hs-varid">v</span> <span class="hs-keyglyph">=&gt;</span> <span class="hs-conid">Scalar</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">v</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">v</span>
<a name="line-54"></a><a name="s"></a><span class="hs-definition">s</span> <span class="hs-varop">|*</span> <span class="hs-varid">v</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">vmap</span> <span class="hs-layout">(</span><span class="hs-varop">*</span><span class="hs-varid">s</span><span class="hs-layout">)</span> <span class="hs-varid">v</span>
<a name="line-55"></a>
<a name="line-56"></a><a name="*|"></a><span class="hs-comment">{- |
<a name="line-57"></a>  Multiply a vector by a scalar. This scales the magnitude
<a name="line-58"></a>  (length) of the vector, but leaves its length unchanged.
<a name="line-59"></a>  (Except in the case of a negative scalar, in which case
<a name="line-60"></a>  the vector's direction is reversed.)
<a name="line-61"></a>
<a name="line-62"></a>  The operators '*|' and '|*' are identical, just with their
<a name="line-63"></a>  arguments flipped.
<a name="line-64"></a>-}</span>
<a name="line-65"></a><span class="hs-layout">(</span><span class="hs-varop">*|</span><span class="hs-layout">)</span> <span class="hs-keyglyph">::</span> <span class="hs-conid">Vector</span> <span class="hs-varid">v</span> <span class="hs-keyglyph">=&gt;</span> <span class="hs-varid">v</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Scalar</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">v</span>
<a name="line-66"></a><a name="v"></a><span class="hs-definition">v</span> <span class="hs-varop">*|</span> <span class="hs-varid">s</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">vmap</span> <span class="hs-layout">(</span><span class="hs-varop">*</span><span class="hs-varid">s</span><span class="hs-layout">)</span> <span class="hs-varid">v</span>
<a name="line-67"></a>
<a name="line-68"></a><a name="vnormalise"></a><span class="hs-comment">{- |
<a name="line-69"></a>  Adjust a vector so that its length is exactly one. (Or,
<a name="line-70"></a>  if the vector's length was zero, it stays zero.)
<a name="line-71"></a>-}</span>
<a name="line-72"></a><span class="hs-definition">vnormalise</span> <span class="hs-keyglyph">::</span> <span class="hs-conid">Vector</span> <span class="hs-varid">v</span> <span class="hs-keyglyph">=&gt;</span> <span class="hs-varid">v</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-varid">v</span>
<a name="line-73"></a><span class="hs-definition">vnormalise</span> <span class="hs-varid">v</span> <span class="hs-keyglyph">=</span>
<a name="line-74"></a>  <span class="hs-keyword">let</span> <span class="hs-varid">m</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">vmag</span> <span class="hs-varid">v</span>
<a name="line-75"></a>  <span class="hs-keyword">in</span>  <span class="hs-keyword">if</span> <span class="hs-varid">m</span> <span class="hs-varop">&lt;</span> <span class="hs-num">1e-10</span> <span class="hs-keyword">then</span> <span class="hs-varid">v</span> <span class="hs-keyword">else</span> <span class="hs-varid">v</span> <span class="hs-varop">*|</span> <span class="hs-layout">(</span><span class="hs-num">1</span><span class="hs-varop">/</span><span class="hs-varid">m</span><span class="hs-layout">)</span>
<a name="line-76"></a>
<a name="line-77"></a><a name="Vector2"></a><span class="hs-comment">{- |
<a name="line-78"></a>  The type of 2-dimensional vectors. It provides various
<a name="line-79"></a>  class instances such as 'Eq', 'Num', 'Show', etc.
<a name="line-80"></a>-}</span>
<a name="line-81"></a><a name="Vector2"></a><span class="hs-keyword">data</span> <span class="hs-conid">Vector2</span> <span class="hs-keyglyph">=</span> <span class="hs-conid">Vector2</span> <span class="hs-layout">{</span><span class="hs-varid">v2x</span><span class="hs-layout">,</span> <span class="hs-varid">v2y</span> <span class="hs-keyglyph">::</span> <span class="hs-comment">{-# UNPACK #-}</span> <span class="hs-varop">!</span><span class="hs-conid">Scalar</span><span class="hs-layout">}</span>
<a name="line-82"></a>  <span class="hs-keyword">deriving</span> <span class="hs-layout">(</span><span class="hs-conid">Eq</span><span class="hs-layout">,</span> <span class="hs-conid">Ord</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span><span class="hs-layout">)</span>
<a name="line-83"></a>
<a name="line-84"></a><span class="hs-keyword">instance</span> <span class="hs-conid">Vector</span> <span class="hs-conid">Vector2</span> <span class="hs-keyword">where</span>
<a name="line-85"></a>  <span class="hs-varid">fromScalar</span> <span class="hs-varid">x</span> <span class="hs-keyglyph">=</span> <span class="hs-conid">Vector2</span> <span class="hs-varid">x</span> <span class="hs-varid">x</span>
<a name="line-86"></a>  <span class="hs-varid">vmap</span>  <span class="hs-varid">f</span> <span class="hs-layout">(</span><span class="hs-conid">Vector2</span> <span class="hs-varid">x1</span> <span class="hs-varid">y1</span><span class="hs-layout">)</span>                 <span class="hs-keyglyph">=</span> <span class="hs-conid">Vector2</span> <span class="hs-layout">(</span><span class="hs-varid">f</span> <span class="hs-varid">x1</span><span class="hs-layout">)</span>    <span class="hs-layout">(</span><span class="hs-varid">f</span> <span class="hs-varid">y1</span><span class="hs-layout">)</span>
<a name="line-87"></a>  <span class="hs-varid">vzip</span>  <span class="hs-varid">f</span> <span class="hs-layout">(</span><span class="hs-conid">Vector2</span> <span class="hs-varid">x1</span> <span class="hs-varid">y1</span><span class="hs-layout">)</span> <span class="hs-layout">(</span><span class="hs-conid">Vector2</span> <span class="hs-varid">x2</span> <span class="hs-varid">y2</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=</span> <span class="hs-conid">Vector2</span> <span class="hs-layout">(</span><span class="hs-varid">f</span> <span class="hs-varid">x1</span> <span class="hs-varid">x2</span><span class="hs-layout">)</span> <span class="hs-layout">(</span><span class="hs-varid">f</span> <span class="hs-varid">y1</span> <span class="hs-varid">y2</span><span class="hs-layout">)</span>
<a name="line-88"></a>  <span class="hs-varid">vfold</span> <span class="hs-varid">f</span> <span class="hs-layout">(</span><span class="hs-conid">Vector2</span> <span class="hs-varid">x1</span> <span class="hs-varid">y1</span><span class="hs-layout">)</span>                 <span class="hs-keyglyph">=</span> <span class="hs-varid">f</span> <span class="hs-varid">x1</span> <span class="hs-varid">y1</span>
<a name="line-89"></a>
<a name="line-90"></a><span class="hs-keyword">instance</span> <span class="hs-conid">Num</span> <span class="hs-conid">Vector2</span> <span class="hs-keyword">where</span>
<a name="line-91"></a>  <span class="hs-layout">(</span><span class="hs-varop">+</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">vzip</span> <span class="hs-layout">(</span><span class="hs-varop">+</span><span class="hs-layout">)</span>
<a name="line-92"></a>  <span class="hs-layout">(</span><span class="hs-comment">-</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">vzip</span> <span class="hs-layout">(</span><span class="hs-comment">-</span><span class="hs-layout">)</span>
<a name="line-93"></a>  <span class="hs-layout">(</span><span class="hs-varop">*</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">vzip</span> <span class="hs-layout">(</span><span class="hs-varop">*</span><span class="hs-layout">)</span>
<a name="line-94"></a>  <span class="hs-varid">negate</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">vmap</span> <span class="hs-varid">negate</span>
<a name="line-95"></a>  <span class="hs-varid">abs</span>    <span class="hs-keyglyph">=</span> <span class="hs-varid">vmap</span> <span class="hs-varid">abs</span>
<a name="line-96"></a>  <span class="hs-varid">signum</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">vmap</span> <span class="hs-varid">signum</span>
<a name="line-97"></a>  <span class="hs-varid">fromInteger</span> <span class="hs-varid">n</span> <span class="hs-keyglyph">=</span> <span class="hs-keyword">let</span> <span class="hs-varid">s</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">fromInteger</span> <span class="hs-varid">n</span> <span class="hs-keyword">in</span> <span class="hs-varid">fromScalar</span> <span class="hs-varid">s</span>
<a name="line-98"></a>
<a name="line-99"></a><span class="hs-keyword">instance</span> <span class="hs-conid">Fractional</span> <span class="hs-conid">Vector2</span> <span class="hs-keyword">where</span>
<a name="line-100"></a>  <span class="hs-layout">(</span><span class="hs-varop">/</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">vzip</span> <span class="hs-layout">(</span><span class="hs-varop">/</span><span class="hs-layout">)</span>
<a name="line-101"></a>  <span class="hs-varid">recip</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">vmap</span> <span class="hs-varid">recip</span>
<a name="line-102"></a>  <span class="hs-varid">fromRational</span> <span class="hs-varid">r</span> <span class="hs-keyglyph">=</span> <span class="hs-keyword">let</span> <span class="hs-varid">s</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">fromRational</span> <span class="hs-varid">r</span> <span class="hs-keyword">in</span> <span class="hs-varid">fromScalar</span> <span class="hs-varid">s</span>
<a name="line-103"></a>
<a name="line-104"></a><a name="vector2X"></a><span class="hs-comment">-- | Constant: The unit-length X vector, (1, 0).</span>
<a name="line-105"></a><span class="hs-definition">vector2X</span> <span class="hs-keyglyph">::</span> <span class="hs-conid">Vector2</span>
<a name="line-106"></a><span class="hs-definition">vector2X</span> <span class="hs-keyglyph">=</span> <span class="hs-conid">Vector2</span> <span class="hs-num">1</span> <span class="hs-num">0</span>
<a name="line-107"></a>
<a name="line-108"></a><a name="vector2Y"></a><span class="hs-comment">-- | Constant: The unit-length Y vector, (0, 1).</span>
<a name="line-109"></a><span class="hs-definition">vector2Y</span> <span class="hs-keyglyph">::</span> <span class="hs-conid">Vector2</span>
<a name="line-110"></a><span class="hs-definition">vector2Y</span> <span class="hs-keyglyph">=</span> <span class="hs-conid">Vector2</span> <span class="hs-num">0</span> <span class="hs-num">1</span>
<a name="line-111"></a>
<a name="line-112"></a>
<a name="line-113"></a>
<a name="line-114"></a><a name="Vector3"></a><span class="hs-comment">{- |
<a name="line-115"></a>  The type of 3-dimensional vectors. Similar to 'Vector2'.
<a name="line-116"></a>-}</span>
<a name="line-117"></a><a name="Vector3"></a><span class="hs-keyword">data</span> <span class="hs-conid">Vector3</span> <span class="hs-keyglyph">=</span> <span class="hs-conid">Vector3</span> <span class="hs-layout">{</span><span class="hs-varid">v3x</span><span class="hs-layout">,</span> <span class="hs-varid">v3y</span><span class="hs-layout">,</span> <span class="hs-varid">v3z</span> <span class="hs-keyglyph">::</span> <span class="hs-comment">{-# UNPACK #-}</span> <span class="hs-varop">!</span><span class="hs-conid">Scalar</span><span class="hs-layout">}</span>
<a name="line-118"></a>  <span class="hs-keyword">deriving</span> <span class="hs-layout">(</span><span class="hs-conid">Eq</span><span class="hs-layout">,</span> <span class="hs-conid">Ord</span><span class="hs-layout">,</span> <span class="hs-conid">Show</span><span class="hs-layout">)</span>
<a name="line-119"></a>
<a name="line-120"></a><span class="hs-keyword">instance</span> <span class="hs-conid">Vector</span> <span class="hs-conid">Vector3</span> <span class="hs-keyword">where</span>
<a name="line-121"></a>  <span class="hs-varid">fromScalar</span> <span class="hs-varid">x</span> <span class="hs-keyglyph">=</span> <span class="hs-conid">Vector3</span> <span class="hs-varid">x</span> <span class="hs-varid">x</span> <span class="hs-varid">x</span>
<a name="line-122"></a>  <span class="hs-varid">vmap</span>  <span class="hs-varid">f</span> <span class="hs-layout">(</span><span class="hs-conid">Vector3</span> <span class="hs-varid">x1</span> <span class="hs-varid">y1</span> <span class="hs-varid">z1</span><span class="hs-layout">)</span>                    <span class="hs-keyglyph">=</span> <span class="hs-conid">Vector3</span> <span class="hs-layout">(</span><span class="hs-varid">f</span> <span class="hs-varid">x1</span><span class="hs-layout">)</span>    <span class="hs-layout">(</span><span class="hs-varid">f</span> <span class="hs-varid">y1</span><span class="hs-layout">)</span>    <span class="hs-layout">(</span><span class="hs-varid">f</span> <span class="hs-varid">z1</span><span class="hs-layout">)</span>
<a name="line-123"></a>  <span class="hs-varid">vzip</span>  <span class="hs-varid">f</span> <span class="hs-layout">(</span><span class="hs-conid">Vector3</span> <span class="hs-varid">x1</span> <span class="hs-varid">y1</span> <span class="hs-varid">z1</span><span class="hs-layout">)</span> <span class="hs-layout">(</span><span class="hs-conid">Vector3</span> <span class="hs-varid">x2</span> <span class="hs-varid">y2</span> <span class="hs-varid">z2</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=</span> <span class="hs-conid">Vector3</span> <span class="hs-layout">(</span><span class="hs-varid">f</span> <span class="hs-varid">x1</span> <span class="hs-varid">x2</span><span class="hs-layout">)</span> <span class="hs-layout">(</span><span class="hs-varid">f</span> <span class="hs-varid">y1</span> <span class="hs-varid">y2</span><span class="hs-layout">)</span> <span class="hs-layout">(</span><span class="hs-varid">f</span> <span class="hs-varid">z1</span> <span class="hs-varid">z2</span><span class="hs-layout">)</span>
<a name="line-124"></a>  <span class="hs-varid">vfold</span> <span class="hs-varid">f</span> <span class="hs-layout">(</span><span class="hs-conid">Vector3</span> <span class="hs-varid">x1</span> <span class="hs-varid">y1</span> <span class="hs-varid">z1</span><span class="hs-layout">)</span>                    <span class="hs-keyglyph">=</span> <span class="hs-varid">f</span> <span class="hs-varid">x1</span> <span class="hs-layout">(</span><span class="hs-varid">f</span> <span class="hs-varid">y1</span> <span class="hs-varid">z1</span><span class="hs-layout">)</span>
<a name="line-125"></a>
<a name="line-126"></a><span class="hs-keyword">instance</span> <span class="hs-conid">Num</span> <span class="hs-conid">Vector3</span> <span class="hs-keyword">where</span>
<a name="line-127"></a>  <span class="hs-layout">(</span><span class="hs-varop">+</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">vzip</span> <span class="hs-layout">(</span><span class="hs-varop">+</span><span class="hs-layout">)</span>
<a name="line-128"></a>  <span class="hs-layout">(</span><span class="hs-comment">-</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">vzip</span> <span class="hs-layout">(</span><span class="hs-comment">-</span><span class="hs-layout">)</span>
<a name="line-129"></a>  <span class="hs-layout">(</span><span class="hs-varop">*</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">vzip</span> <span class="hs-layout">(</span><span class="hs-varop">*</span><span class="hs-layout">)</span>
<a name="line-130"></a>  <span class="hs-varid">negate</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">vmap</span> <span class="hs-varid">negate</span>
<a name="line-131"></a>  <span class="hs-varid">abs</span>    <span class="hs-keyglyph">=</span> <span class="hs-varid">vmap</span> <span class="hs-varid">abs</span>
<a name="line-132"></a>  <span class="hs-varid">signum</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">vmap</span> <span class="hs-varid">signum</span>
<a name="line-133"></a>  <span class="hs-varid">fromInteger</span> <span class="hs-varid">n</span> <span class="hs-keyglyph">=</span> <span class="hs-keyword">let</span> <span class="hs-varid">s</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">fromInteger</span> <span class="hs-varid">n</span> <span class="hs-keyword">in</span> <span class="hs-varid">fromScalar</span> <span class="hs-varid">s</span>
<a name="line-134"></a>
<a name="line-135"></a><span class="hs-keyword">instance</span> <span class="hs-conid">Fractional</span> <span class="hs-conid">Vector3</span> <span class="hs-keyword">where</span>
<a name="line-136"></a>  <span class="hs-layout">(</span><span class="hs-varop">/</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">vzip</span> <span class="hs-layout">(</span><span class="hs-varop">/</span><span class="hs-layout">)</span>
<a name="line-137"></a>  <span class="hs-varid">recip</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">vmap</span> <span class="hs-varid">recip</span>
<a name="line-138"></a>  <span class="hs-varid">fromRational</span> <span class="hs-varid">r</span> <span class="hs-keyglyph">=</span> <span class="hs-keyword">let</span> <span class="hs-varid">s</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">fromRational</span> <span class="hs-varid">r</span> <span class="hs-keyword">in</span> <span class="hs-varid">fromScalar</span> <span class="hs-varid">s</span>
<a name="line-139"></a>
<a name="line-140"></a><a name="vcross"></a><span class="hs-comment">{- |
<a name="line-141"></a>  Takes the /cross product/ of two [3D] vectors. Again, from highschool
<a name="line-142"></a>  linear algebra, the cross product of vector V and W is a new vector
<a name="line-143"></a>  P such that |P| = |V| * |W| * sin k (where k is the minimum angle
<a name="line-144"></a>  between V and W), and the direction of P is perpendicular to both
<a name="line-145"></a>  V and W. For example, @vcross 'vector3X' 'vector3Y' = 'vector3Z'@.
<a name="line-146"></a>  Note also that @vcross w v = negate (vcross v w)@.
<a name="line-147"></a>-}</span>
<a name="line-148"></a><span class="hs-definition">vcross</span> <span class="hs-keyglyph">::</span> <span class="hs-conid">Vector3</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Vector3</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Vector3</span>
<a name="line-149"></a><span class="hs-definition">vcross</span> <span class="hs-layout">(</span><span class="hs-conid">Vector3</span> <span class="hs-varid">x1</span> <span class="hs-varid">y1</span> <span class="hs-varid">z1</span><span class="hs-layout">)</span> <span class="hs-layout">(</span><span class="hs-conid">Vector3</span> <span class="hs-varid">x2</span> <span class="hs-varid">y2</span> <span class="hs-varid">z2</span><span class="hs-layout">)</span> <span class="hs-keyglyph">=</span> <span class="hs-conid">Vector3</span>
<a name="line-150"></a>  <span class="hs-layout">{</span>
<a name="line-151"></a>    <span class="hs-varid">v3x</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">y1</span> <span class="hs-varop">*</span> <span class="hs-varid">z2</span>   <span class="hs-comment">-</span>   <span class="hs-varid">y2</span> <span class="hs-varop">*</span> <span class="hs-varid">z1</span><span class="hs-layout">,</span>
<a name="line-152"></a>    <span class="hs-varid">v3y</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">z1</span> <span class="hs-varop">*</span> <span class="hs-varid">x2</span>   <span class="hs-comment">-</span>   <span class="hs-varid">z2</span> <span class="hs-varop">*</span> <span class="hs-varid">x1</span><span class="hs-layout">,</span>
<a name="line-153"></a>    <span class="hs-varid">v3z</span> <span class="hs-keyglyph">=</span> <span class="hs-varid">x1</span> <span class="hs-varop">*</span> <span class="hs-varid">y2</span>   <span class="hs-comment">-</span>   <span class="hs-varid">x2</span> <span class="hs-varop">*</span> <span class="hs-varid">y1</span>
<a name="line-154"></a>  <span class="hs-layout">}</span>
<a name="line-155"></a>
<a name="line-156"></a><a name="vector3X"></a><span class="hs-comment">-- | Constant: The unit-length X vector, (1, 0, 0).</span>
<a name="line-157"></a><span class="hs-definition">vector3X</span> <span class="hs-keyglyph">::</span> <span class="hs-conid">Vector3</span>
<a name="line-158"></a><span class="hs-definition">vector3X</span> <span class="hs-keyglyph">=</span> <span class="hs-conid">Vector3</span> <span class="hs-num">1</span> <span class="hs-num">0</span> <span class="hs-num">0</span>
<a name="line-159"></a>
<a name="line-160"></a><a name="vector3Y"></a><span class="hs-comment">-- | Constant: The unit-length Y vector, (0, 1, 0).</span>
<a name="line-161"></a><span class="hs-definition">vector3Y</span> <span class="hs-keyglyph">::</span> <span class="hs-conid">Vector3</span>
<a name="line-162"></a><span class="hs-definition">vector3Y</span> <span class="hs-keyglyph">=</span> <span class="hs-conid">Vector3</span> <span class="hs-num">0</span> <span class="hs-num">1</span> <span class="hs-num">0</span>
<a name="line-163"></a>
<a name="line-164"></a><a name="vector3Z"></a><span class="hs-comment">-- | Constant: The unit-length Z vector, (0, 0, 1).</span>
<a name="line-165"></a><span class="hs-definition">vector3Z</span> <span class="hs-keyglyph">::</span> <span class="hs-conid">Vector3</span>
<a name="line-166"></a><span class="hs-definition">vector3Z</span> <span class="hs-keyglyph">=</span> <span class="hs-conid">Vector3</span> <span class="hs-num">0</span> <span class="hs-num">0</span> <span class="hs-num">1</span>
</pre>

</body></html>